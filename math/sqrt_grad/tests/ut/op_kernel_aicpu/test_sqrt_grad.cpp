/**
 * Copyright (c) 2025 Huawei Technologies Co., Ltd.
 * This program is free software, you can redistribute it and/or modify it under the terms and conditions of
 * CANN Open Software License Agreement Version 2.0 (the "License").
 * Please refer to the License for details. You may not use this file except in compliance with the License.
 * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED,
 * INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY, OR FITNESS FOR A PARTICULAR PURPOSE.
 * See LICENSE in the root of the software repository for the full text of the License.
 */

#include "gtest/gtest.h"
#ifndef private
#define private public
#define protected public
#endif
#include "utils/aicpu_test_utils.h"
#include "cpu_kernel_utils.h"
#include "node_def_builder.h"
#include "utils/kernel_util.h"
#undef private
#undef protected
#include "Eigen/Core"

using namespace std;
using namespace aicpu;

const std::complex<double> input1_complex_128_data[] = {
    {255.51778331416807, 493.28428064256735}, {189.21642887856638, 422.9624618551131},
    {191.30425427608088, 636.2123092489329},  {285.3423262625907, 809.4188808831198},
    {843.5170629759497, 842.6029056227326},   {584.8336970074541, 388.8249463220522},
    {656.2351301928152, 774.803545841446},    {908.0497581213087, 435.3205897291309},
    {183.86485000043663, 689.5000839252998},  {563.4140377490135, 684.2691246197903},
    {623.9434861625737, 959.7652875475345},   {316.8507232210781, 45.21912854252863},
    {503.79170529401654, 54.72120641319567},  {682.0062807175921, 967.6470828489697},
    {705.3190834752072, 264.92652606263135},  {110.09068179107916, 12.519765200265542},
    {776.106930860971, 564.4858403946105},    {763.935654831643, 744.1175634670666},
    {568.8814747326946, 478.59387219962247},  {670.1710037192297, 196.27940921020536},
    {915.0639067726722, 808.5939549805672},   {789.20453236424, 0.7545343850057229},
    {136.60738030110164, 956.3610636352302},  {75.67297998181944, 61.41261187520841},
    {383.0111870426415, 420.10174732938833},  {307.69934528825735, 71.73844390573126},
    {885.0286123932566, 195.99043617786927},  {644.1490541366636, 233.55441350459128},
    {85.05131794220566, 274.94161478597},     {542.190035286086, 500.62666886903605},
    {585.2650478456573, 605.8732751533662},   {850.4607383263404, 220.64156920941625},
    {613.1919998947128, 334.52121210792217},  {934.0327297544266, 327.6232350429599},
    {168.1954442460458, 466.94006786320784},  {114.51843026917207, 170.47834197290234},
    {940.185259243672, 168.06936665156945},   {0.14845596210477652, 857.5765829352331},
    {441.0798958317319, 499.12798655060664},  {564.9353322435329, 843.5617930508027},
    {338.3398265542942, 772.0025793328388},   {463.2598121185487, 258.1938584819304},
    {534.6826396968255, 96.3112786010506},    {342.28932437364756, 185.6257593220324},
    {425.86862384416514, 744.1020174059004},  {720.9468256148623, 448.04168692812965},
    {136.7630930680065, 817.8676407446342},   {40.79971796205173, 341.7446990605839},
    {6.592590188208569, 994.4446290486749},   {311.2747796038385, 731.9356699033361},
    {660.5501147933493, 226.9438877496035},   {564.6535578862532, 513.6411917005752},
    {32.0604314020464, 380.59073660333576},   {792.4344760945096, 244.59313670096174},
    {739.9930091602317, 777.0036210316356},   {51.19613430267012, 656.0076245178011},
    {141.630649919974, 478.948259061177},     {490.07680472127845, 895.126447594976},
    {526.6626076596651, 104.97375764564443},  {188.5271904003658, 66.91156119171393},
    {571.650383198059, 160.2980179278891},    {117.48456412887087, 717.1582520878288},
    {210.3679791222183, 217.57688560182166},  {560.0291014550598, 480.5632598695081},
    {623.771853993682, 780.8116168637254},    {576.5100705606532, 707.4328993136529},
    {481.55686093607966, 775.0262352660671},  {630.0854392695863, 315.1130646819232},
    {982.4854586038617, 821.1133635262993},   {491.54119921540416, 365.44074900545485},
    {569.4020793428657, 185.3932074880875},   {480.30561603956113, 731.1372093390622},
    {715.5481698094374, 61.65510812360453},   {910.8023585875, 634.9365511907266},
    {183.8417704465345, 224.88088018459052},  {193.30995456444043, 691.8337546254296},
    {581.1869529292145, 714.5962896658363},   {518.0687385860499, 506.28736084022677},
    {895.9617018339105, 812.1197678493311},   {187.3229140582744, 464.8025479806764},
    {475.4207462735702, 159.5324838015977},   {258.3802863200142, 205.38428108922847},
    {858.825214727733, 925.8422996984073},    {510.5916774209117, 384.6328667038801},
    {646.9673847265152, 44.3463810135597},    {794.6384771258608, 100.36766090324345},
    {844.0207012343595, 80.39471823244449},   {682.2542677584565, 953.4976995061223},
    {844.5012887591416, 696.4391914361231},   {182.24245768695724, 142.46088642233357},
    {718.7387850297797, 83.36517233795493},   {413.4838160143934, 516.7865429372908},
    {972.6801504975056, 902.2752136962858},   {178.2994756440125, 736.7705666136873},
    {807.2917913231884, 903.0573732599587},   {543.5085740288903, 141.86913677510717},
    {250.37907196085175, 949.2258394040142},  {94.60795862362336, 979.2171423231325},
    {9.667728270461362, 585.7412903943499},   {102.916928195246, 441.1898949529871},
    {400.5857510702693, 673.2126604915696},   {888.4644691313284, 325.8907138714312},
    {177.3050318625422, 784.9325064983208},   {767.5726866325674, 297.4071228087506},
    {509.309276459066, 747.8296343169501},    {425.87916412736257, 525.4835940186323},
    {942.5392786297849, 172.28967112121651},  {893.8218168384085, 86.6167864162054},
    {232.27023462831477, 61.73983342573985},  {863.8821200171009, 266.48234352214826},
    {326.5334369979076, 445.0050095763217},   {949.065522808018, 694.7411548076905},
    {369.81328307028883, 828.4783790657794},  {228.797540969076, 401.77189801348214},
    {692.170505229114, 131.60016544940578},   {968.8181806056892, 964.5719886640392},
    {926.9075408500054, 503.3732317600043},   {439.67133669240144, 701.7899153838475},
    {957.9212702069246, 743.4439376294246},   {217.37308812868272, 410.3822630908702},
    {27.518790555716265, 626.4314146895873},  {972.0256939448902, 99.25570396975836},
    {413.04630836294797, 904.6834305935126},  {830.3283429517036, 991.1303245874846},
    {992.6116292020236, 47.29326583631921},   {681.5933353208777, 991.5091737597514},
    {52.857729114159866, 363.08223733547294}, {803.1457112153253, 80.40239349265855},
    {221.90842991313198, 430.48968681475077}, {251.52667953280948, 10.253269933854781},
    {793.4514227556555, 921.4154129303597},   {13.59466545796828, 69.41457047328502},
    {664.192166388781, 125.35517782563122},   {755.4840489342448, 187.29042288482933},
    {288.40392103939206, 773.5844793508581},  {208.101229916541, 750.7246883002625},
    {155.19527312598836, 563.2869336371306},  {911.1664332338668, 742.9085808491162},
    {702.5340837352439, 676.8963509847172},   {228.6800402491931, 200.9592123255789},
    {279.8236713974849, 12.091380612329061},  {728.534747110063, 52.43362984921263},
    {478.92067658318126, 584.2203281546726},  {98.88979512813656, 611.281087829304},
    {155.03422657020982, 149.0763027809764},  {820.1520693444143, 436.3300794638837},
    {194.18041831875288, 884.2683958856169},  {295.32315659902685, 218.39413930647478},
    {183.02982552636672, 977.9918504972319},  {617.8314853006103, 276.1242604261919},
    {916.5069042743121, 443.47232446763365},  {840.3160735834961, 547.783193885782},
    {412.70627213403765, 99.48543968493418},  {519.6718338826505, 696.9706847660161},
    {493.53413755715724, 986.1179995904198},  {841.3303403233593, 950.6552131471723},
    {1.0726942946808204, 873.3844827254121},  {277.52638786022334, 868.7978446519069},
    {104.47172024900597, 596.4940521778307},  {496.82762872162766, 545.3383957372864},
    {569.6479921449393, 660.2640841999829},   {317.1467664897827, 123.32981849157166},
    {733.5067846424655, 766.1655237809385},   {39.7806260316983, 579.2098025287006},
    {374.4574453473282, 782.5972853344647},   {608.4206789218767, 350.0196645671622},
    {206.3501370144498, 314.6413847946049},   {783.6964219555157, 323.2993252340638},
    {290.0366492417759, 836.1809292475469},   {159.989392851115, 485.83200862723265},
    {30.023650763896015, 51.80804192223631},  {480.54489017796465, 68.24720084321356},
    {192.87467757716627, 840.3164776667538},  {428.37648700002916, 695.648530497112},
    {181.81164618316515, 308.16299684225766}, {881.3205931360932, 279.9217432565796},
    {533.8105174527167, 12.944327837661973},  {410.48261351509177, 543.9366118171781},
    {699.5687213631643, 93.25040861601164},   {852.3061562682534, 84.72070810866128},
    {610.1487750847739, 968.9881019988752},   {879.2970863054841, 997.9323387357298},
    {285.87899479617107, 453.66064918637375}, {259.0120515369857, 183.87305789284235},
    {393.5388549451142, 669.2426123152339},   {696.5814181397857, 917.5041735267348},
    {208.2698975292294, 351.2986495674699},   {835.4889270554569, 436.7307695431331},
    {390.471753252114, 874.3967643431341},    {246.24952917083164, 207.12037956480867},
    {175.4713777121043, 262.79847968744997},  {200.56757642470978, 751.7905252313915},
    {852.0320506888972, 781.2728710695536},   {264.98196112339645, 824.2356450230768},
    {268.68509358804147, 253.18968584394563}, {733.0508785057608, 361.97332136309524},
    {496.5867146147147, 19.623810415470455},  {67.8358488850489, 228.52106077062672},
    {932.6871231318872, 211.48567038073475},  {47.05867930293262, 879.4300885989314},
    {704.6297929124307, 394.7253349877104},   {70.86849566111042, 688.8483887445013},
    {79.7732471464776, 211.14244585971753},   {215.42148946375482, 214.78777370717094},
    {63.81437742120477, 498.657812907937},    {799.7281489601917, 28.867046340154467},
    {397.27093857024664, 933.7883908297482},  {464.3246468188258, 95.56096280186243},
    {92.99858606917743, 859.7977605548026},   {237.1838923346864, 201.36328353777034},
    {442.0834424577397, 938.0742744551042},   {795.9876705005111, 855.4847965610286},
    {973.6569405627118, 342.12999812143},     {984.8063991392362, 271.05143404400144},
    {569.5195695718216, 309.75149242981604},  {217.22865180094396, 396.7317175552554}};

const std::complex<double> input2_complex_128_data[] = {
    {584.2323193498696, 916.4223649537009},   {560.4624617164018, 446.4979520996899},
    {801.1156814014669, 435.2421846618768},   {969.8326659381693, 623.8829692426781},
    {976.7656709423891, 481.7767338789348},   {689.6304830199946, 295.88927784076714},
    {807.0773594816479, 838.6679983896694},   {11.500397021240172, 536.6657821249355},
    {998.7612594895836, 900.2187164130413},   {894.5662298931821, 52.17192665730297},
    {967.6060349752381, 595.7154094586849},   {117.84729622751134, 98.54770835324045},
    {41.31247463565168, 465.9027732898331},   {443.5292814586583, 43.97529335128014},
    {484.42216965730057, 895.2762777063065},  {700.7359515742324, 604.5588440934908},
    {577.5715486126699, 393.4549674605217},   {358.31884912483434, 494.5685638072993},
    {527.4628498572808, 991.7120872694269},   {946.4679191516265, 362.1411889008377},
    {269.1371667738115, 648.9132394869665},   {414.67504999939075, 728.850173697307},
    {293.1607426239111, 945.7917544011004},   {8.083482778667328, 449.7246637400658},
    {299.59284308879484, 377.55359746286297}, {180.72228654583412, 258.93723798520915},
    {317.6471022160395, 691.9934281397141},   {381.06547836229555, 16.427020334415012},
    {522.2437371776003, 914.9291845574272},   {273.9638161351343, 375.3315266002338},
    {186.3790050391283, 565.160890569807},    {140.82994537806948, 771.8952657306456},
    {306.96730886260406, 745.5201135292564},  {243.67101511015653, 658.2934488002256},
    {168.70546748422498, 75.34905453144958},  {95.9184614362344, 763.7218599232917},
    {422.81089493789534, 419.59932629528686}, {90.4672425094527, 88.08058568594402},
    {371.6274760914915, 478.9676063617665},   {443.5974715359912, 544.944031775946},
    {573.5012625922519, 376.089823250903},    {845.3087562976376, 868.2736970284441},
    {312.865087531097, 347.86468727063436},   {483.04764061611706, 103.68659257193758},
    {302.96703418329264, 86.04619099685974},  {698.8072887644852, 811.9233608251969},
    {778.0408842153234, 123.51653622690495},  {575.919004882875, 265.0534966179056},
    {187.98766389646414, 682.1427339055847},  {404.38938907485044, 121.833554670017},
    {780.333030212052, 937.8184211265877},    {365.29095807409664, 871.0948638901624},
    {381.62312989839086, 160.86980720173517}, {880.2483371881049, 457.0437545498188},
    {217.45108894617405, 647.1630081278547},  {918.9825444634342, 535.1005386722591},
    {767.8890248956426, 286.5744197035677},   {330.2497214891805, 570.9997544437731},
    {284.4182768190886, 19.73781376170458},   {467.15294435798495, 592.3790426196906},
    {387.3537257499858, 742.5255677943854},   {676.5214784065366, 771.9807730926892},
    {460.9025631347988, 560.4899437008036},   {270.01210916756366, 902.6029066374126},
    {540.1752241945157, 787.5932844324918},   {29.729721201163017, 227.05956051766373},
    {160.22405676808748, 143.10547985787426}, {523.1454227556792, 97.01449553298724},
    {431.8132770690982, 592.5416313995795},   {935.1819315207965, 314.3318002921411},
    {950.7600650737777, 789.6917091166973},   {775.378073874672, 969.6894877416636},
    {468.21203605924546, 47.75473881684433},  {12.861601404352886, 379.69599964841626},
    {231.37701803774402, 175.85663758365112}, {852.8122757882379, 787.900737665978},
    {560.9718643545, 774.1464476350645},      {294.78151581622467, 636.4668805888308},
    {643.7292886997438, 335.9424217655873},   {858.7760304850361, 674.3274148039426},
    {160.0930064077698, 676.076627745684},    {515.3060315675596, 198.60355854305612},
    {723.6269413702795, 472.6476549099313},   {374.0923387142725, 846.588286003348},
    {191.70722371425708, 573.743402145343},   {993.239020497085, 750.6572292366965},
    {914.4592794705885, 431.1588866800491},   {596.9199529176097, 602.4825343761229},
    {127.6173447898049, 718.9275423472928},   {210.95054379324708, 544.1240740605369},
    {837.252114111906, 640.0794419813515},    {33.2502352822801, 875.4480193279251},
    {160.05863675054667, 969.902348988622},   {419.45541285692434, 77.51362003511775},
    {257.8742638431911, 3.016637644242537},   {784.7332335002659, 127.8110900992867},
    {52.93431020087036, 732.7594218496334},   {620.1215458606147, 804.3747560332623},
    {260.5861050157769, 411.28695241566726},  {182.87097177900603, 282.88621998781906},
    {916.2262760102418, 446.07517451483835},  {270.6642392095936, 342.7671870799357},
    {921.5294801766231, 489.4162579748789},   {229.44640205232335, 659.2108684066295},
    {841.1366012055782, 116.86661317451619},  {515.4070834522855, 797.6078970044141},
    {278.81834961973226, 572.5624930969832},  {621.6086514329669, 479.2491079344161},
    {761.1073154427562, 592.241090984633},    {753.2449849808991, 714.245405414459},
    {44.31187280674587, 792.5572202528152},   {41.88060096746993, 44.28627630429249},
    {790.8481309284247, 589.3051677541798},   {811.298519839884, 69.48709075572812},
    {635.3743454270635, 860.587376011758},    {861.5075279730295, 502.3859757808762},
    {904.5960662748104, 261.9143711488101},   {68.48753984024869, 187.20798853957277},
    {666.0161552902521, 661.3056157628512},   {455.5029314630208, 53.0630306549128},
    {327.42526942374127, 81.34237641903508},  {512.3318457809287, 659.3150293879265},
    {888.4213633276075, 867.1266496461042},   {46.58474077496011, 63.45353138796816},
    {244.18785185376302, 442.1264019709678},  {350.53058928306393, 506.7704059097892},
    {438.38357023931184, 388.134450232987},   {909.761809682445, 302.64145102286113},
    {617.2523808790539, 951.7224411249607},   {233.48686472915904, 671.8234102037791},
    {955.1690502813999, 399.18198880785906},  {556.1462177507243, 296.98800252977907},
    {793.372845700226, 517.1318598041493},    {871.5269191311479, 989.0893484771472},
    {47.76412896370219, 305.9450919197264},   {278.252789267728, 182.22071052240963},
    {322.83939484039195, 612.2783067661844},  {429.0068723292543, 70.94063827403185},
    {214.89541534951283, 135.20154140931584}, {611.6152222248604, 484.1175294406106},
    {967.676757631785, 240.33392824174894},   {185.51430053674568, 977.0947486417652},
    {402.7637434751854, 342.87216313481815},  {45.347910459088595, 16.12803426236631},
    {978.1104517593013, 259.74805690733314},  {213.04880412013904, 981.3884226697825},
    {723.036639306691, 567.4724266251774},    {531.7859389597651, 303.36808703550923},
    {974.7327956557685, 732.4877104944673},   {326.67208753847456, 871.6064682610736},
    {92.82215819416895, 164.2530162924204},   {677.2771434435475, 78.56660832599249},
    {896.4187231003026, 116.86104479957481},  {386.0177505253365, 283.1686901394528},
    {872.8605383156493, 969.0000802019767},   {52.98898506654049, 140.41720204387076},
    {595.5257696782242, 571.5604371948672},   {814.7431231909497, 320.3472483792219},
    {840.7194135138037, 888.1598306541117},   {212.0755237543971, 460.9536956240159},
    {942.8929319774359, 459.34686115180835},  {983.0498868740628, 795.0402414938123},
    {157.47787408701575, 375.29431085884266}, {735.9383580971036, 283.62163682675447},
    {376.5658898523535, 287.8772961150978},   {215.83820137064347, 133.61432171467558},
    {111.02034617876045, 393.4741568760156},  {953.9037034151614, 672.7414992517101},
    {13.017675937525897, 147.7127289604514},  {31.509655488440423, 610.4127853939077},
    {568.9479243690337, 535.7344324117594},   {62.01898231484093, 647.8191195362907},
    {308.6301495798559, 35.396145366324184},  {677.7569837299069, 31.784803552374562},
    {89.36908686310241, 782.3279464183953},   {598.2483985978705, 393.3892456926241},
    {591.4307532152443, 370.0056415884282},   {921.3579642562838, 577.5930043427951},
    {840.9190024581105, 361.615048952774},    {172.75353020451445, 432.70470245295866},
    {515.7513280119556, 670.6778917596804},   {155.91210141722178, 18.50698235332282},
    {119.6849363069945, 76.69124877727785},   {515.2171039354965, 306.87774638983535},
    {397.51203976095695, 814.1157395297507},  {326.4351586194472, 896.2942004380376},
    {710.5737017462658, 4.269069532427672},   {801.8814818728719, 389.56608340275403},
    {443.3367508184989, 606.1366654140062},   {364.8069348470506, 775.9625777652473},
    {555.456226303922, 460.9108685891085},    {522.9476406465978, 297.92963944399276},
    {578.8990600833596, 963.2256699463335},   {181.6561101688632, 120.4505796868932},
    {231.86578422361416, 5.102371552966334},  {443.4273980195742, 862.1446098675641},
    {158.29120647828788, 428.4687034110829},  {896.6526288693304, 903.8097368601075},
    {778.9125060768748, 991.5886534146298},   {732.5190629188878, 568.5149852508082},
    {197.8910388646994, 762.3383743405258},   {547.7755556314359, 964.7777337828551},
    {138.53356914434244, 174.88547908260742}, {659.2023699844584, 606.0746764859839},
    {665.5723674599608, 339.04565060189384},  {68.37453321757492, 853.8843502242578},
    {206.47270110097804, 282.2024465114912},  {683.9411807593397, 59.30110683793577},
    {144.31785690031884, 34.72435449486211},  {202.86431808079018, 217.17365108327456},
    {910.2907279808741, 741.1810524716177},   {259.5875539352712, 217.82668964910167},
    {735.4210987173133, 362.1311715681984},   {643.9650058956931, 192.88463996018845},
    {716.2500289301041, 9.650604604900415},   {767.6381399401156, 879.9947696925993}};

const std::complex<double> output_exp_complex_128_data[] = {
    {-0.4905324614538074, 0.8462785927933145},     {-0.19283448653296703, 0.7488103846745002},
    {-0.1400768524570552, 0.6717178091160735},     {-0.15493809473118728, 0.6537118689016365},
    {0.14701787922631995, 0.4324347131368661},     {0.29223547711680326, 0.4472606212025261},
    {-0.05828054950891409, 0.5701889544861747},    {-0.11004234895930366, 0.24275012337911683},
    {-0.42915308482815695, 0.8387044625459348},    {0.2980371686291166, 0.40826742040305275},
    {0.012203591249090207, 0.49615116570505724},   {0.16050386703690328, 0.17841745348420956},
    {-0.009115792047059548, 0.46140608720627624},  {0.09273710909131547, 0.16381731799030377},
    {0.09203534594411278, 0.669230075277967},      {2.8336421175929805, 3.067979510396326},
    {0.12278007862147117, 0.3427815021565307},     {-0.04145075808300161, 0.28332234976355825},
    {-0.1579250598221557, 0.7387726554719485},     {0.5774725472212416, 0.4393155824710425},
    {-0.09335968959680449, 0.2720755755461081},    {0.2622753818529448, 0.4620132902053815},
    {-0.4631316545494138, 0.21942295786992083},    {-1.421737435716908, 1.8176860826009886},
    {-0.06786172090679057, 0.41844201063470887},   {0.18548593346569936, 0.4640084335963796},
    {0.08853889720808879, 0.4105511235052884},     {0.2573364082682069, 0.10605552183140005},
    {-1.250410759985215, 1.3365417671701598},      {-0.03613728482850487, 0.3127583757325514},
    {-0.1644088040325311, 0.31262680967396084},    {-0.032735789059460396, 0.4453171556669909},
    {-0.06267809190907439, 0.573707591662965},     {0.006085442155830775, 0.35452767991645806},
    {-0.013819271699669483, 0.18562783160040924},  {-1.4132424686934595, 1.2306638919327937},
    {0.17923719746494696, 0.25518794625538493},    {-0.05134522322675752, 0.05275475643748626},
    {-0.08468794066989607, 0.4471155537418465},    {-0.10142633927419603, 0.33085668500315824},
    {-0.06777563064369427, 0.4011409219388192},    {0.2976009246994569, 1.103000014642768},
    {0.22662218652014443, 0.36612113737120144},    {0.4817840787479791, 0.4127351385888121},
    {0.04421253102326136, 0.17827500026214904},    {0.09717299146407937, 0.6234845836912594},
    {0.003917254751175395, 0.47499703726859355},   {-0.28316166010472665, 0.8764215484093864},
    {-0.34233507903508226, 0.09678840230997637},   {0.029007767937358098, 0.2639102258692152},
    {0.3101663747050933, 0.816440057173839},       {-0.20695344319173795, 0.5830966867366575},
    {-0.16791713490014953, 0.5155014083760289},    {0.42582722392531625, 0.4198155225490072},
    {-0.14849670105543394, 0.2813526980057203},    {-0.35104482104854967, 0.7278321046761238},
    {-0.05712090706607181, 0.8185322239359724},    {-0.16768788259808398, 0.2762791816767276},
    {0.2561097580442168, 0.06978606420492486},     {0.6051279207950612, 1.7858409415424321},
    {0.14526447002170717, 0.6901917712531628},     {-0.4489063324125982, 0.5452078434057641},
    {-0.1364194695009192, 1.1910712342555159},     {-0.25941684918218066, 0.5832469165655533},
    {-0.13918079005356215, 0.4570944691920025},    {-0.08614648366521449, 0.09121596696954903},
    {-0.020270850749786067, 0.11596200431687427},  {0.3012829194916466, 0.22766028688126755},
    {-0.01899768308535213, 0.285675031405769},     {0.45955203520894267, 0.6613991677986275},
    {0.5507152650024777, 0.8727483477463289},      {-0.21989897286460003, 0.6747129571089369},
    {0.3219049621242878, 0.06110623504964664},     {-0.09303459649932037, 0.14358431634314348},
    {0.01771952885893996, 0.49995766367366845},    {-0.36844694433668324, 0.7192921661254815},
    {-0.13387886239668664, 0.5013944033249287},    {-0.16153126203532067, 0.4564108704777362},
    {0.1039233537853806, 0.2816743397809698},      {-0.3037468497658588, 1.0462222343430363},
    {-0.06311677909733404, 0.6898502850465954},    {0.4238675595057668, 0.721252832063413},
    {0.05764858916036952, 0.33731814675400684},    {-0.16471119838194354, 0.704948432391064},
    {0.11721408812837103, 0.451444274595747},      {0.5564283318928424, 0.542606527574971},
    {0.512746617280676, 0.3042597921891934},       {-0.060821703777610286, 0.3565355675315264},
    {-0.16395970349472966, 0.2904386424371994},    {-0.36511061602786393, 1.2074467049095507},
    {0.5237520242517287, 0.5060286244879696},      {-0.5007238245966649, 0.432802127805854},
    {-0.2043603092376434, 0.3090038720869816},     {0.015383103691129323, 0.28093536371558836},
    {0.07001465606824053, 0.08018856492359648},    {0.6471315469867678, 0.28649693204714527},
    {-0.35399336794734093, 0.12125637679612031},   {-0.37661521163700334, 0.3530285105811731},
    {-0.34731639598689285, 0.22817379488167103},   {-0.2581996867145347, 0.2674780312448287},
    {0.05436324792722197, 0.6481399134487006},     {0.07189296192305122, 0.21926914242713105},
    {-0.1704616105442813, 0.6255167639413541},     {-0.014711232681072162, 0.42371258707170856},
    {0.20827239833950617, 0.42054128596461887},    {-0.21817057688499128, 0.6672289080725806},
    {0.08940043311687794, 0.32007580438118766},    {0.3187522725437187, 0.29897888644411985},
    {1.2137692872557748, 1.5975291009566723},      {0.2816457728560353, 0.5002723384209612},
    {-0.5550938630020776, 0.4571019178852642},     {0.0032456254434889593, 0.025707400737350717},
    {-0.11891103176936352, 0.5303686319630904},    {0.3688681849729888, 0.7995908321233947},
    {0.3288897039905313, 0.6841892624547498},      {0.093647741402694, 0.3525150362430397},
    {0.3175772712130738, 0.31374982951564334},     {-0.07383035981053009, 0.09504961733457867},
    {0.04976712097282371, 0.38380176293874707},    {0.1790695605640676, 0.46012359535149144},
    {-0.053341669431086015, 0.26368494470011233},  {0.22654522096139473, 0.3622778927296916},
    {-0.21106718343806002, 0.58737806466826},      {-0.007240792360852044, 0.029566853907250265},
    {0.11213713830439515, 0.2280514612340553},     {-0.09102558894591921, 0.2393399231102115},
    {-0.43734380526887995, 0.6673661242327066},    {0.5420798024021786, 0.24267730794909093},
    {-0.5813602039410009, 1.0165979207264417},     {0.4090195245849576, 1.352164682201485},
    {0.13190697868770074, 0.404728138900504},      {-1.3046329667700998, 4.261485097251791},
    {0.5057585026378936, 0.4847473264967902},      {0.3905177324836682, 0.7514187841560559},
    {-0.16350925625647675, 0.09183066233705317},   {-0.06499724836263245, 0.20334005839736458},
    {-0.43175811611840337, 0.40552425865909775},   {0.12234465466391255, 0.1386807155081245},
    {0.031234238465025745, 0.12631858695821505},   {0.22969734279620002, 1.260357316221546},
    {1.7073388770311537, 0.5032134973215504},      {0.07864955611515889, 0.676249496662099},
    {-0.006501913382078783, 0.3500319359642049},   {-0.007007959595958536, 0.03822622911700478},
    {1.22049168530209, 2.0113004939087564},        {-0.14685230262629245, 0.5201695519728707},
    {-0.22046255726699066, 0.4572455977487777},    {0.33649729726678423, 0.7624633426190018},
    {-0.27170668678504606, 0.5491833342286307},    {-0.0424091193269126, 0.6864218763709029},
    {0.005899026261261528, 0.0924625473514424},    {0.26142451459210125, 0.21716502333233692},
    {0.9941295704393361, 0.3812201326749928},      {0.002144853695973392, 0.27532614987026843},
    {-0.21577300134438768, 0.5505645485732403},    {-0.027583796578649504, 0.052281391622160465},
    {-0.3267908694744991, 0.34133126639722605},    {-0.03137915550014361, 0.4789147531118024},
    {-0.6025731648865927, 0.8102537822529774},     {-0.13414395048177596, 0.31665509718776585},
    {0.15374291596688253, 0.5813842245664361},     {0.922854522303325, 1.6122995896701808},
    {-0.07645336875375774, 0.17596458930682518},   {-0.2002577328741474, 0.6490490240129282},
    {-0.05598955575643738, 0.26737717452142185},   {0.08580737663929557, 0.15916853815293636},
    {-0.35631617887316375, 0.4101051916757752},    {0.36877151555862453, 0.5813403238905714},
    {-0.07643044589865118, 0.0342945735716164},    {-0.5571180430351532, 0.21589315510969895},
    {-1.4884227505281773, 6.353489435664894},      {-0.030581694020402617, 0.6697031876356561},
    {0.020033416703247823, 0.1790410398951915},    {0.20093701259853722, 0.3634044912292975},
    {-0.8781297706134151, 0.6630866284501323},     {0.24391248267309074, 0.3006522623683742},
    {0.5452461194250117, 0.35979183443735085},     {0.0689411532292934, 0.7949085021641524},
    {0.5566841484122165, 0.33266002564038655},     {0.07536759724006353, 0.26133513854732954},
    {-0.12781760191079658, 0.3466125296619106},    {0.03352803085069078, 0.04857538832086605},
    {-0.0010023003389968213, 0.13254181264064452}, {0.38168249474748467, 0.8633575129857404},
    {-0.32218915900989953, 0.4864453736242659},    {-0.22417002952063506, 0.3480858895170347},
    {0.4391568689584584, 0.7509954709496481},      {0.28118889224955324, 0.3801209958817625},
    {-0.1945903565658836, 0.34040658113263433},    {-0.3423107710714876, 1.2876440946581644},
    {-0.11847389722775203, 1.1359155938667047},    {-0.09835738654779524, 0.3740418554491738},
    {-0.09701886634828769, 0.47629033014099836},   {-0.0341151577920083, 0.12116432612835615},
    {0.22380224038715757, 0.22039036077703095},    {0.009711043873474268, 0.5928475860017007},
    {0.14210895304064, 0.4370295549020739},        {-1.2821646726348384, 2.342466998919498},
    {0.282504427652565, 0.595633788863178},        {-0.30008427164544954, 0.43253136991101515},
    {-0.12377093920220032, 0.47161454862472685},   {-0.6524719575249268, 0.4647285079522875},
    {-0.2539456689540572, 0.4240021698095743},     {0.06391236018897006, 1.470442584854786},
    {-0.2504525186310308, 0.6994148015973883},     {0.023447840365168664, 0.5347055065680981},
    {-0.08812119624695089, 0.1480467547562961},    {0.6939547061287425, 0.2066776638608174},
    {-0.01098712745388516, 0.08511387110512034},   {0.02265080784212234, 0.4770470096841525},
    {-0.1361598798034508, 0.549358836940627},      {0.007426512148474576, 0.1448095458395327},
    {0.27798973292232765, 0.2836463245740136},     {0.27887099366325907, 0.17468479375860937},
    {0.4817160813199266, 0.27046933178178445},     {-0.4457057554954746, 1.2114966085849164}};

class TEST_SQRTGRAD_UT : public testing::Test {};

#define CREATE_NODEDEF(shapes, data_types, datas)                    \
    auto node_def = CpuKernelUtils::CpuKernelUtils::CreateNodeDef(); \
    NodeDefBuilder(node_def.get(), "SqrtGrad", "SqrtGrad")           \
        .Input({"x1", (data_types)[0], (shapes)[0], (datas)[0]})     \
        .Input({"x2", (data_types)[1], (shapes)[1], (datas)[1]})     \
        .Output({"y", (data_types)[2], (shapes)[2], (datas)[2]})

template <typename T1, typename T2, typename T3>
void RunSqrtGradKernel(
    vector<DataType>& data_types, vector<vector<int64_t>>& shapes, const T1* input1_data, const T2* input2_data,
    const T3* output_exp_data)
{
    uint64_t input1_size = CalTotalElements(shapes, 0);
    T1* input1 = new T1[input1_size];
    uint64_t input2_size = CalTotalElements(shapes, 1);
    T2* input2 = new T2[input2_size];

    for (uint64_t i = 0; i < input1_size; ++i) {
        input1[i] = input1_data[i];
    }
    for (uint64_t i = 0; i < input2_size; ++i) {
        input2[i] = input2_data[i];
    }

    uint64_t output_size = CalTotalElements(shapes, 2);
    T3* output = new T3[output_size];
    vector<void*> datas = {(void*)input1, (void*)input2, (void*)output};

    CREATE_NODEDEF(shapes, data_types, datas);
    RUN_KERNEL(node_def, HOST, KERNEL_STATUS_OK);

    T3* output_exp = new T3[output_size];
    for (uint64_t i = 0; i < output_size; ++i) {
        output_exp[i] = output_exp_data[i];
    }

    bool compare = CompareResult(output, output_exp, output_size);
    EXPECT_EQ(compare, true);
    delete[] input1;
    delete[] input2;
    delete[] output;
    delete[] output_exp;
}

TEST_F(TEST_SQRTGRAD_UT, DATA_TYPE_FLOAT_SUCC_1D)
{
    vector<DataType> data_types = {DT_FLOAT, DT_FLOAT, DT_FLOAT};
    vector<vector<int64_t>> shapes = {{15}, {15}, {15}};
    const float input1_data[] = {81.3377f,   42.911854f, 67.3148f,   23.028294f, 35.85503f,
                                 22.392572f, 10.274563f, 61.913395f, 83.20328f,  49.58565f,
                                 68.719315f, 67.43358f,  46.36467f,  54.379158f, 98.67426f};
    const float input2_data[] = {70.72506f,  92.57594f,  92.54831f,  99.74494f,  98.53133f,
                                 46.88357f,  14.914657f, 78.41768f,  46.443245f, 94.559235f,
                                 36.245827f, 53.333603f, 52.865215f, 9.609693f,  6.6154857f};
    const float output_exp_data[] = {0.43476185f, 1.0786756f,  0.6874292f,  2.165704f,   1.3740238f,
                                     1.0468554f,  0.7258049f,  0.6332853f,  0.27909505f, 0.95349395f,
                                     0.26372373f, 0.39545286f, 0.57010233f, 0.08835823f, 0.03352184f};

    RunSqrtGradKernel<float, float, float>(data_types, shapes, input1_data, input2_data, output_exp_data);
}

TEST_F(TEST_SQRTGRAD_UT, DATA_TYPE_FLOAT_SUCC_2D)
{
    vector<DataType> data_types = {DT_FLOAT, DT_FLOAT, DT_FLOAT};
    vector<vector<int64_t>> shapes = {{5, 4}, {5, 4}, {5, 4}};

    const float input1_data[] = {81.3377f,   42.911854f, 67.3148f,  23.028294f, 35.85503f, 22.392572f, 10.274563f,
                                 61.913395f, 83.20328f,  49.58565f, 68.719315f, 67.43358f, 46.36467f,  54.379158f,
                                 98.67426f,  70.72506f,  92.57594f, 92.54831f,  99.74494f, 98.53133f};
    const float input2_data[] = {46.88357f,  14.914657f, 78.41768f,  46.443245f, 94.559235f, 36.245827f, 53.333603f,
                                 52.865215f, 9.609693f,  6.6154857f, 46.305958f, 14.527651f, 22.289686f, 45.292423f,
                                 93.17653f,  86.726875f, 78.947334f, 79.180954f, 88.99657f,  12.250699f};
    const float output_exp_data[] = {0.2882032f,  0.17378248f, 0.5824698f,  1.0083953f,  1.3186327f,
                                     0.809327f,   2.5954194f,  0.42692876f, 0.05774828f, 0.066707656f,
                                     0.33692098f, 0.10771823f, 0.24037363f, 0.4164502f,  0.472142f,
                                     0.61312693f, 0.4263923f,  0.42778173f, 0.4461207f,  0.06216652f};

    RunSqrtGradKernel<float, float, float>(data_types, shapes, input1_data, input2_data, output_exp_data);
}

TEST_F(TEST_SQRTGRAD_UT, DATA_TYPE_DOUBLE_SUCC)
{
    vector<DataType> data_types = {DT_DOUBLE, DT_DOUBLE, DT_DOUBLE};
    vector<vector<int64_t>> shapes = {{4}, {1, 4}, {1, 4}};
    const double input1_data[] = {10.781199089932201, -41.860360996593336, -50.7085103391488, 10.803046413067776};
    const double input2_data[] = {98.25495763333197, -78.63643171862495, -14.023209677262358, 48.8215643107506};
    const double output_exp_data[] = {4.556773175865258, 0.9392708262241755, 0.13827274340610962, 2.259620223962668};

    RunSqrtGradKernel<double, double, double>(data_types, shapes, input1_data, input2_data, output_exp_data);
}

TEST_F(TEST_SQRTGRAD_UT, DATA_TYPE_COMPLEX128_SUCC)
{
    vector<DataType> data_types = {DT_COMPLEX128, DT_COMPLEX128, DT_COMPLEX128};
    vector<vector<int64_t>> shapes = {{6, 6, 6}, {6, 6, 6}, {6, 6, 6}};
    vector<string> files{
        "sqrt_grad/data/sqrtgrad_data_input1_11.txt", "sqrt_grad/data/sqrtgrad_data_input2_11.txt",
        "sqrt_grad/data/sqrtgrad_data_output1_11.txt"};
    RunSqrtGradKernel<std::complex<double>, std::complex<double>, std::complex<double>>(
        data_types, shapes, input1_complex_128_data, input2_complex_128_data, output_exp_complex_128_data);
}
// exception instance

TEST_F(TEST_SQRTGRAD_UT, INPUT_BOOL_UNSUPPORT)
{
    vector<DataType> data_types = {DT_BOOL, DT_BOOL, DT_BOOL};
    vector<vector<int64_t>> shapes = {{2, 11}, {2, 11}, {2, 11}};
    bool input1[22] = {(bool)1};
    bool input2[22] = {(bool)0};
    bool output[22] = {(bool)0};
    vector<void*> datas = {(void*)input1, (void*)input2, (void*)output};
    CREATE_NODEDEF(shapes, data_types, datas);
    RUN_KERNEL(node_def, HOST, KERNEL_STATUS_PARAM_INVALID);
}

TEST_F(TEST_SQRTGRAD_UT, INPUT_NULL_EXCEPTION)
{
    vector<DataType> data_types = {DT_FLOAT, DT_FLOAT, DT_FLOAT};
    vector<vector<int64_t>> shapes = {{2, 11}, {2, 11}, {2, 11}};
    float output[22] = {0};
    vector<void*> datas = {(void*)nullptr, (void*)nullptr, (void*)output};
    CREATE_NODEDEF(shapes, data_types, datas);
    RUN_KERNEL(node_def, HOST, KERNEL_STATUS_PARAM_INVALID);
}

TEST_F(TEST_SQRTGRAD_UT, INPUT_DTYPE_EXCEPTION)
{
    vector<DataType> data_types = {DT_FLOAT, DT_FLOAT16, DT_FLOAT};
    vector<vector<int64_t>> shapes = {{2, 11}, {2, 11}, {2, 11}};
    float input1[22] = {(float)1};
    Eigen::half input2[22] = {(Eigen::half)0};
    float output[22] = {0};
    vector<void*> datas = {(void*)input1, (void*)input2, (void*)output};
    CREATE_NODEDEF(shapes, data_types, datas);
    RUN_KERNEL(node_def, HOST, KERNEL_STATUS_PARAM_INVALID);
}

TEST_F(TEST_SQRTGRAD_UT, DATA_TYPE_FLOAT16_DIV0)
{
    vector<DataType> data_types = {DT_FLOAT16, DT_FLOAT16, DT_FLOAT16};
    vector<vector<int64_t>> shapes = {{2, 11}, {2, 11}, {2, 11}};
    Eigen::half input1[22] = {(Eigen::half)1};
    Eigen::half input2[22] = {(Eigen::half)0};
    Eigen::half output[22] = {(Eigen::half)0};
    vector<void*> datas = {(void*)input1, (void*)input2, (void*)output};
    CREATE_NODEDEF(shapes, data_types, datas);
    RUN_KERNEL(node_def, HOST, KERNEL_STATUS_OK);
}