# TanhGrad

## 产品支持情况

| 产品                                                                | 是否支持 |
|:----------------------------------------------------------------- |:----:|
| <term>Atlas A2 训练系列产品/Atlas 800I A2 推理产品/A200I A2 Box 异构组件</term> | √    |

## 功能说明

+ 算子功能：计算 tanh_grad(dy, y) = dy * (1 - y²)。

+ 计算公式如下：

$$
dx = dy \cdot (1 - y^2)
$$

## 参数说明

| 参数名 | 类别  | 描述                       | 数据类型                       | 数据格式                    |
|:---:|:---:|:------------------------:|:--------------------------:|:-----------------------:|
| dy  | 输入  | 待进行tanh_grad计算的入参，公式中的dy | bfloat16, float16, float32 | FRACTAL_NZ, NC1HWC0, ND |
| y   | 输入  | 待进行tanh_grad计算的入参，公式中的y  | bfloat16, float16, float32 | FRACTAL_NZ, NC1HWC0, ND |
| dx  | 输出  | 待进行tanh_grad计算的出参，公式中的dx | bfloat16, float16, float32 | FRACTAL_NZ, NC1HWC0, ND |

## 约束说明

无

## 调用说明

| 调用方式    | 样例代码                                                        | 说明                                                                  |
|:------- |:----------------------------------------------------------- |:------------------------------------------------------------------- |
| aclnn接口 | [test_aclnn_tanh_grad](./examples/test_aclnn_tanh_grad.cpp) | 通过[aclnnTanhBackward](./docs/aclnnTanhBackward.md)接口方式调用TanhGrad算子。 |

## 贡献说明

| 贡献者      | 贡献方   | 贡献算子     | 贡献时间       | 贡献内容            |
| -------- | ----- | -------- | ---------- | --------------- |
| zdt258 | 个人开发者 | TanhGrad | 2025/12/24 | TanhGRad算子适配开源仓 |